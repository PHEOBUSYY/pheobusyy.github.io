<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>android binder与AIDL | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="android binder与AIDL  最近重新研究了一下Activity启动流程,里面主要提到了ActivityManagerService这个类来管理Activity的生命周期,而如何和这个类通讯成为了理解Activity启动流程的关键,而实现与ActivityManagerService通讯的基础就是今天要讲到的Binder知识.
  我们知道你通过Luncher点击app图标来启动响应的">
<meta property="og:type" content="article">
<meta property="og:title" content="android binder与AIDL">
<meta property="og:url" content="http://yoursite.com/2017/02/21/2017/android binder与aidl/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="android binder与AIDL  最近重新研究了一下Activity启动流程,里面主要提到了ActivityManagerService这个类来管理Activity的生命周期,而如何和这个类通讯成为了理解Activity启动流程的关键,而实现与ActivityManagerService通讯的基础就是今天要讲到的Binder知识.
  我们知道你通过Luncher点击app图标来启动响应的">
<meta property="og:image" content="http://yoursite.com/images/2017/02/android binder结构图.gif">
<meta property="og:image" content="http://yoursite.com/images/2017/02/android binder调用关系图.jpg">
<meta property="og:image" content="http://yoursite.com/images/2017/02/android aidl目录结构.png">
<meta property="og:image" content="http://yoursite.com/images/2017/02/android aidl目录2.png">
<meta property="og:updated_time" content="2017-02-25T01:12:01.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="android binder与AIDL">
<meta name="twitter:description" content="android binder与AIDL  最近重新研究了一下Activity启动流程,里面主要提到了ActivityManagerService这个类来管理Activity的生命周期,而如何和这个类通讯成为了理解Activity启动流程的关键,而实现与ActivityManagerService通讯的基础就是今天要讲到的Binder知识.
  我们知道你通过Luncher点击app图标来启动响应的">
<meta name="twitter:image" content="http://yoursite.com/images/2017/02/android binder结构图.gif">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2017/android binder与aidl" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/21/2017/android binder与aidl/" class="article-date">
  <time datetime="2017-02-21T07:59:00.000Z" itemprop="datePublished">2017-02-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      android binder与AIDL
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="android-binder与AIDL"><a href="#android-binder与AIDL" class="headerlink" title="android binder与AIDL"></a>android binder与AIDL</h2><p>  最近重新研究了一下Activity启动流程,里面主要提到了ActivityManagerService这个类来管理Activity的生命周期,而如何和这个类通讯成为了理解Activity启动流程的关键,而实现与ActivityManagerService通讯的基础就是今天要讲到的Binder知识.</p>
<p>  我们知道你通过Luncher点击app图标来启动响应的app的时候,实际上就是相当于在Luncher这个app中取启动另一个app,也就是两个app的通讯,并且这两个app分属于不同的 <em>线程</em> ,在android两个不同线程的通讯有个统一的说法叫做 <em>IPC(inter-process connection)</em> .我们可以想象一下如果你要让两个陌生人之间互相认识,是不是需要一个中间人,那么在这里的进程就好比两个陌生人,而中间人就是我们这里的IPC,binder机制是IPC的一种实现方式.</p>
<a id="more"></a>
<h2 id="binder机制相比于其他IPC方式的优点"><a href="#binder机制相比于其他IPC方式的优点" class="headerlink" title="binder机制相比于其他IPC方式的优点"></a>binder机制相比于其他IPC方式的优点</h2><p>  在linux的原有IPC主要有下面几种:</p>
<ul>
<li>System V IPC (消息队列/信号量/共享内存)</li>
<li>管道 / FIFO</li>
<li>SOCKET</li>
<li><p>读,写锁定文件</p>
<p>在手机系统中,我们如果要使两个进程来通讯,要考虑的因素的主要有:</p>
</li>
<li>性能</li>
<li>稳定性</li>
<li><p>安全</p>
<p><a href="https://www.ibm.com/developerworks/cn/linux/l-ipc/" target="_blank" rel="external">点我查看Linux IPC</a></p>
<p>可以这样理解,如果两个进程直接通讯的时候需要消耗大量的内存和电量,那手机是肯定无法支撑的.同时如果其中一个进程发生问题,对另一个进程造成了影响的话这也是不合理的.最后,如果没有一种安全机制来对非法进程进行检查的话,容易发生信息泄漏等安全问题.</p>
<p>上面提到的这几种IPC方式都或多或少的无法满足移动手机上的IPC要求,比如System V IPC,管道,SOCKET都需要对数据做两次拷贝,先拷贝到内存,然后再逐次的写入或者读出,而共享内存和文件读写的话虽然不需要数据拷贝,但是需要上层的进程完成同步控制,手段比较复杂.另外就是在安全性上他们都无法有效的识别出发送方和接收方的有效身份.基于上面提到的几点,android就提出了使用Binder这种新的IPC方式来满足我们的需求.</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>IPC方式</th>
<th>数据拷贝次数</th>
</tr>
</thead>
<tbody>
<tr>
<td>  共享内存</td>
<td>0</td>
</tr>
<tr>
<td>  Binder</td>
<td>1</td>
</tr>
<tr>
<td>  System V IPC/SOCKET/读,写锁定文件</td>
<td>2</td>
</tr>
</tbody>
</table>
<h2 id="binder的核心原理"><a href="#binder的核心原理" class="headerlink" title="binder的核心原理"></a>binder的核心原理</h2><p><img src="/images/2017/02/android binder结构图.gif" alt="android binder结构"></p>
<h3 id="用户空间和内核空间"><a href="#用户空间和内核空间" class="headerlink" title="用户空间和内核空间"></a>用户空间和内核空间</h3><p>  linux中的应用都是运行在自己独立的空间中,这个空间称为用户空间,一般来说指的就是应用运行所在的进程.之所以要这样做的目的就是为了保证每个应用的独立性,应用之间互不干扰,相互隔离.不过总会有应用需要用到系统中公共的资源,或者请求调用一些系统的功能,这个时候在linux唯一的实现方式就是 <em>系统调用</em> .通过 <em>系统调用</em> 这个唯一的接口,应用在内核的监控下执行,这种情况下我们就说应用处于 <em>内核态</em> .在linux系统中主要采用了0和3这两个特权级对应用户态和内核态.<br>  其中内核态对应0,代表最高的执行权限,这个时候可以操作系统的高权限操作.而用户态对应3,代表最低的用户权限,这个时候只能执行应用内部的代码.</p>
<h3 id="内核模块和驱动"><a href="#内核模块和驱动" class="headerlink" title="内核模块和驱动"></a>内核模块和驱动</h3><p>  想象一下两个独立的应用程序(进程)想要相互通信该如何实现呢?还是上面提到的两个陌生人要认识对方最好的方式就是找个中间人,那么在linux我们可以想到可以把内核作为这个中间人.我们让内核帮我们找到对方,然后调用对方的方法就完成了一次通讯.那么前面提到了:在linux中本来是没有binder这种IPC方式的,如何让linux的内核支持binder呢?我们可以通过动态可加载内核模块(LKM:Loadable Kernel Moudle)这种方式来实现.模块是具有独立的功能,可以被单独编译但是不能直接运行.它在运行时被链接到内核中,作为内核中的一部分.这样,android通过添加一个内核模块来实现binder的相关功能.也就是我们上图中的 <em>binder驱动</em> 来帮助我们实现binder这种IPC方式.</p>
<h3 id="4个角色"><a href="#4个角色" class="headerlink" title="4个角色"></a>4个角色</h3><p>  根据上面的图片我们介绍一下binder中的4个重要角色:</p>
<ol>
<li>client</li>
<li>server</li>
<li>serverManager</li>
<li><p>binder驱动</p>
<p>在binder中,通过定义client和server来明确请求的发送方和接收方.而serviceManager对应是的一个管理者的角色.首先在系统启动的时候server把自己注册到serverManager中,然后每当client请求相关的服务的时候,首先是到ServiceManager中查找对应的server,这个时候并不会把server对象直接返回给client,而是会返回一个server对象的代理对象,这个代理对象并不是真正的server.当client拿到代理对象之后,就可以像真正获取到了server,调用server的方法了,而代理对象又会通过binder驱动去调用真正的server,完成真正的调用.</p>
</li>
</ol>
<p><img src="/images/2017/02/android binder调用关系图.jpg" alt="  android binder调用关系"></p>
<p>  通过上图可以看到4个角色之间的调用关系.</p>
<h3 id="binder通讯模型-binder中4个角色-通过打电话的例子来类比"><a href="#binder通讯模型-binder中4个角色-通过打电话的例子来类比" class="headerlink" title="binder通讯模型(binder中4个角色,通过打电话的例子来类比)"></a>binder通讯模型(binder中4个角色,通过打电话的例子来类比)</h3><p>  我们可以通过一个打电话的例子来说明binder的通讯模型,假设A要给B打电话,那么这里A对应client,B对应server,首先A不知道B的手机号码是什么,需要先去通讯录去查B的电话号码,这里的通讯录对应ServerManager,ServerManager里面有想要服务的对象,当知道B的电话号码后开始拨号,通过基站来把信号传递给B的手机,这里的基站对应Binder驱动.可能唯一的不适合的地方就是在系统中binder驱动只有一份,serverManager也只有一份.</p>
<h3 id="binder驱动中的对象"><a href="#binder驱动中的对象" class="headerlink" title="binder驱动中的对象"></a>binder驱动中的对象</h3><p>  在binder驱动中,有三个对象定义,分别为binder_proc,binder_node,binder_ref.其中binder_proc保存的是进程中的上下文信息,每一个应用空间都有一个binder_proc信息.binder_node叫做binder实体信息,保存的是server在binder驱动中的体现,也就是对应的server的内存地址,这里可以理解成server对象的 <em>指针</em> .binder_ref对应上面讲到的Binder代理对象,client实际上获取到的就是这个代理对象.一个binder_node对应多个binder_ref,因为可以多个代理对象来代理真正的binder_node对象.其中binder_ref到binder_node转换就是binder驱动的核心实现了.这里就不展开了.</p>
<p>  如果对binder驱动内部实现感兴趣可以看 <a href="http://wangkuiwu.github.io/2014/09/01/Binder-Introduce/" target="_blank" rel="external">这里</a></p>
<h2 id="aidl实例"><a href="#aidl实例" class="headerlink" title="aidl实例"></a>aidl实例</h2><p>  我们知道,android提供了aidl的方式来完成IPC,实际上aidl就是一个binder具体实现了,我们通过讲解一个demo来说明如何使用aidl,也帮助我们理解binder在android中的具体实现.</p>
<p>  我们最终要实现的效果是在手机会安装好两个app,在其中client的app中点击后可以获取到server的app中的数据,表明我们的aidl调用成功.</p>
<p>  首先,在AS中创建一个新的工程,里面包含了两个模块,一个代表server,一个代表client,在server中创建两个java 对象,一个叫book,一个叫user.</p>
<p>  <img src="/images/2017/02/android aidl目录结构.png" alt="android aidl目录结构"></p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Book</span> <span class="keyword">implements</span> <span class="title">Parcelable</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> bookId;</div><div class="line">    <span class="keyword">public</span> String name;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Book</span><span class="params">(<span class="keyword">int</span> bookId, String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.bookId = bookId;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">describeContents</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeToParcel</span><span class="params">(Parcel dest, <span class="keyword">int</span> flags)</span> </span>&#123;</div><div class="line">        dest.writeInt(bookId);</div><div class="line">        dest.writeString(name);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Creator&lt;Book&gt; CREATOR = <span class="keyword">new</span> Creator&lt;Book&gt;()&#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="keyword">public</span> Book[] newArray(<span class="keyword">int</span> size) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Book[size];</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> Book <span class="title">createFromParcel</span><span class="params">(Parcel source)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> Book(source);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Book</span><span class="params">(Parcel parcel)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.bookId = parcel.readInt();</div><div class="line">        <span class="keyword">this</span>.name = parcel.readString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> <span class="keyword">implements</span> <span class="title">Parcelable</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">int</span> bookId;</div><div class="line">    <span class="keyword">public</span> String name;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">User</span><span class="params">(<span class="keyword">int</span> bookId, String name)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.bookId = bookId;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line">    &#125;</div><div class="line"></div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">describeContents</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeToParcel</span><span class="params">(Parcel dest, <span class="keyword">int</span> flags)</span> </span>&#123;</div><div class="line">        dest.writeInt(bookId);</div><div class="line">        dest.writeString(name);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> Creator&lt;User&gt; CREATOR = <span class="keyword">new</span> Creator&lt;User&gt;()&#123;</div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="keyword">public</span> User[] newArray(<span class="keyword">int</span> size) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> User[size];</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> User <span class="title">createFromParcel</span><span class="params">(Parcel source)</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> User(source);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">private</span> <span class="title">User</span><span class="params">(Parcel parcel)</span> </span>&#123;</div><div class="line">        <span class="keyword">this</span>.bookId = parcel.readInt();</div><div class="line">        <span class="keyword">this</span>.name = parcel.readString();</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  这两个对象可以自由发挥,只要满足都是实现的 <em>Parcelable</em> 序列化接口就可以.<br>  之后我们开始创建aidl文件,右键新建选择AIDL类型,AS会自动帮我们创建好aidl文件夹并新建好aidl文件.这里写创建三个aidl文件,分别book.aidl,user.aidl,IMyAidlInterface.aidl :</p>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> yonyou.com.testbinderipc;</div><div class="line">parcelable Book;</div></pre></td></tr></table></figure>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> yonyou.com.testbinderipc;</div><div class="line">parcelable User;</div></pre></td></tr></table></figure>
  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> yonyou.com.testbinderipc;</div><div class="line"><span class="comment">// Declare any non-default types here with import statements</span></div><div class="line"><span class="keyword">import</span> yonyou.com.testbinderipc.Book;</div><div class="line"><span class="keyword">import</span> yonyou.com.testbinderipc.User;</div><div class="line"><span class="class"><span class="keyword">interface</span> <span class="title">IMyAidlInterface</span> </span>&#123;</div><div class="line"></div><div class="line">   <span class="function"><span class="keyword">void</span> <span class="title">addBook</span><span class="params">(in Book book)</span></span>;</div><div class="line"></div><div class="line">    <span class="function">List&lt;User&gt; <span class="title">getUser</span><span class="params">()</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>  注意:千万不要忘了在IMyAidlInterface.aidl中使用对象的时候显示声明import相应的对象,因为aidl只会自动导入基础数据类型和List.</p>
<p>  这里在IMyAidlInterface中定义两个方法对应我们server具有的行为.注意到这里的addBook中的参数 <em>in</em> 表明是一种输入类型,还有两个分别兑现 <em>out</em> 和 <em>inout</em> .</p>
<p>  aidl写好之后,我们需要一个service类来用来给其他的app调用.<br>  新建一个android 的service,TestAidlService:<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestAidlService</span> <span class="keyword">extends</span> <span class="title">Service</span> </span>&#123;</div><div class="line"></div><div class="line">  <span class="meta">@Nullable</span></div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">public</span> IBinder <span class="title">onBind</span><span class="params">(Intent intent)</span> </span>&#123;</div><div class="line">      <span class="keyword">return</span> stub;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">private</span> IMyAidlInterface.Stub stub = <span class="keyword">new</span> IMyAidlInterface.Stub() &#123;</div><div class="line"></div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBook</span><span class="params">(Book book, String a , String b)</span> <span class="keyword">throws</span> RemoteException </span>&#123;</div><div class="line">          Log.e(<span class="string">"yy"</span>, <span class="string">"addBook: book = "</span> + book.name);</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getUser</span><span class="params">()</span> <span class="keyword">throws</span> RemoteException </span>&#123;</div><div class="line">          <span class="keyword">return</span> Collections.singletonList(<span class="keyword">new</span> User(<span class="number">1</span>,<span class="string">"yy"</span>));</div><div class="line">      &#125;</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>  内部代码非常简单,这里你可能会问,这个 <em>IMyAidlInterface.Stub</em> 是哪里来的呢?当我们在完成了aidl文件之后,编译工程,会发现在/build/generated/source/aidl/debug/目录下有一个新生成的文件MyAidlInterface.java.这个就是编译起帮助我们生成的真正的aidl java文件了.来看下内部代码.<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div></pre></td><td class="code"><pre><div class="line">  <span class="keyword">package</span> yonyou.com.testbinderipc;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IMyAidlInterface</span> <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">os</span>.<span class="title">IInterface</span> </span>&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * Local-side IPC implementation stub class.</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Stub</span> <span class="keyword">extends</span> <span class="title">android</span>.<span class="title">os</span>.<span class="title">Binder</span> <span class="keyword">implements</span> <span class="title">yonyou</span>.<span class="title">com</span>.<span class="title">testbinderipc</span>.<span class="title">IMyAidlInterface</span> </span>&#123;</div><div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> java.lang.String DESCRIPTOR = <span class="string">"yonyou.com.testbinderipc.IMyAidlInterface"</span>;</div><div class="line"></div><div class="line">        <span class="comment">/**</span></div><div class="line">         * Construct the stub at attach it to the interface.</div><div class="line">         */</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Stub</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">this</span>.attachInterface(<span class="keyword">this</span>, DESCRIPTOR);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="comment">/**</span></div><div class="line">         * Cast an IBinder object into an yonyou.com.testbinderipc.IMyAidlInterface interface,</div><div class="line">         * generating a proxy if needed.</div><div class="line">         */</div><div class="line">        <span class="keyword">public</span> <span class="keyword">static</span> yonyou.com.testbinderipc.<span class="function">IMyAidlInterface <span class="title">asInterface</span><span class="params">(android.os.IBinder obj)</span> </span>&#123;</div><div class="line">            <span class="keyword">if</span> ((obj == <span class="keyword">null</span>)) &#123;</div><div class="line">                <span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">            &#125;</div><div class="line">            android.os.IInterface iin = obj.queryLocalInterface(DESCRIPTOR);</div><div class="line">            <span class="keyword">if</span> (((iin != <span class="keyword">null</span>) &amp;&amp; (iin <span class="keyword">instanceof</span> yonyou.com.testbinderipc.IMyAidlInterface))) &#123;</div><div class="line">                <span class="keyword">return</span> ((yonyou.com.testbinderipc.IMyAidlInterface) iin);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">new</span> yonyou.com.testbinderipc.IMyAidlInterface.Stub.Proxy(obj);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="keyword">public</span> android.os.<span class="function">IBinder <span class="title">asBinder</span><span class="params">()</span> </span>&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTransact</span><span class="params">(<span class="keyword">int</span> code, android.os.Parcel data, android.os.Parcel reply, <span class="keyword">int</span> flags)</span> <span class="keyword">throws</span> android.os.RemoteException </span>&#123;</div><div class="line">            <span class="keyword">switch</span> (code) &#123;</div><div class="line">                <span class="keyword">case</span> INTERFACE_TRANSACTION: &#123;</div><div class="line">                    reply.writeString(DESCRIPTOR);</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">case</span> TRANSACTION_addBook: &#123;</div><div class="line">                    data.enforceInterface(DESCRIPTOR);</div><div class="line">                    yonyou.com.testbinderipc.Book _arg0;</div><div class="line">                    <span class="keyword">if</span> ((<span class="number">0</span> != data.readInt())) &#123;</div><div class="line">                        _arg0 = yonyou.com.testbinderipc.Book.CREATOR.createFromParcel(data);</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        _arg0 = <span class="keyword">null</span>;</div><div class="line">                    &#125;</div><div class="line">                    java.lang.String _arg1;</div><div class="line">                    _arg1 = data.readString();</div><div class="line">                    java.lang.String _arg2;</div><div class="line">                    _arg2 = data.readString();</div><div class="line">                    <span class="keyword">this</span>.addBook(_arg0, _arg1, _arg2);</div><div class="line">                    reply.writeNoException();</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">case</span> TRANSACTION_getUser: &#123;</div><div class="line">                    data.enforceInterface(DESCRIPTOR);</div><div class="line">                    java.util.List&lt;yonyou.com.testbinderipc.User&gt; _result = <span class="keyword">this</span>.getUser();</div><div class="line">                    reply.writeNoException();</div><div class="line">                    reply.writeTypedList(_result);</div><div class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">super</span>.onTransact(code, data, reply, flags);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">yonyou</span>.<span class="title">com</span>.<span class="title">testbinderipc</span>.<span class="title">IMyAidlInterface</span> </span>&#123;</div><div class="line">            <span class="keyword">private</span> android.os.IBinder mRemote;</div><div class="line"></div><div class="line">            Proxy(android.os.IBinder remote) &#123;</div><div class="line">                mRemote = remote;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="keyword">public</span> android.os.<span class="function">IBinder <span class="title">asBinder</span><span class="params">()</span> </span>&#123;</div><div class="line">                <span class="keyword">return</span> mRemote;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">public</span> java.lang.<span class="function">String <span class="title">getInterfaceDescriptor</span><span class="params">()</span> </span>&#123;</div><div class="line">                <span class="keyword">return</span> DESCRIPTOR;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBook</span><span class="params">(yonyou.com.testbinderipc.Book book, java.lang.String a, java.lang.String b)</span> <span class="keyword">throws</span> android.os.RemoteException </span>&#123;</div><div class="line">                android.os.Parcel _data = android.os.Parcel.obtain();</div><div class="line">                android.os.Parcel _reply = android.os.Parcel.obtain();</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    _data.writeInterfaceToken(DESCRIPTOR);</div><div class="line">                    <span class="keyword">if</span> ((book != <span class="keyword">null</span>)) &#123;</div><div class="line">                        _data.writeInt(<span class="number">1</span>);</div><div class="line">                        book.writeToParcel(_data, <span class="number">0</span>);</div><div class="line">                    &#125; <span class="keyword">else</span> &#123;</div><div class="line">                        _data.writeInt(<span class="number">0</span>);</div><div class="line">                    &#125;</div><div class="line">                    _data.writeString(a);</div><div class="line">                    _data.writeString(b);</div><div class="line">                    mRemote.transact(Stub.TRANSACTION_addBook, _data, _reply, <span class="number">0</span>);</div><div class="line">                    _reply.readException();</div><div class="line">                &#125; <span class="keyword">finally</span> &#123;</div><div class="line">                    _reply.recycle();</div><div class="line">                    _data.recycle();</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="meta">@Override</span></div><div class="line">            <span class="keyword">public</span> java.util.List&lt;yonyou.com.testbinderipc.User&gt; getUser() <span class="keyword">throws</span> android.os.RemoteException &#123;</div><div class="line">                android.os.Parcel _data = android.os.Parcel.obtain();</div><div class="line">                android.os.Parcel _reply = android.os.Parcel.obtain();</div><div class="line">                java.util.List&lt;yonyou.com.testbinderipc.User&gt; _result;</div><div class="line">                <span class="keyword">try</span> &#123;</div><div class="line">                    _data.writeInterfaceToken(DESCRIPTOR);</div><div class="line">                    mRemote.transact(Stub.TRANSACTION_getUser, _data, _reply, <span class="number">0</span>);</div><div class="line">                    _reply.readException();</div><div class="line">                    _result = _reply.createTypedArrayList(yonyou.com.testbinderipc.User.CREATOR);</div><div class="line">                &#125; <span class="keyword">finally</span> &#123;</div><div class="line">                    _reply.recycle();</div><div class="line">                    _data.recycle();</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> _result;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TRANSACTION_addBook = (android.os.IBinder.FIRST_CALL_TRANSACTION + <span class="number">0</span>);</div><div class="line">        <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> TRANSACTION_getUser = (android.os.IBinder.FIRST_CALL_TRANSACTION + <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addBook</span><span class="params">(yonyou.com.testbinderipc.Book book, java.lang.String a, java.lang.String b)</span> <span class="keyword">throws</span> android.os.RemoteException</span>;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> java.util.List&lt;yonyou.com.testbinderipc.User&gt; getUser() <span class="keyword">throws</span> android.os.RemoteException;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>  可以看到IMyAidlInterface表明是一个接口,同时内部有两个内部类sub和proxy,这两个对象就对应了上面个讲到的binder实体对象和binder代理对象.<br>  当client和server属于同一个进程时候,可以直接使用stub本地对象,如果不在同一进程中就只能使用proxy对象.这段逻辑对应这里的 <em>asInterface</em> 方法.</p>
<p>  写完service之后,我们需要在manifest中注册:<br>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;service android:name=&quot;.TestAidlService&quot; android:exported=&quot;true&quot; android:process=&quot;:remote&quot; android:enabled=&quot;true&quot;&gt;</div><div class="line">            &lt;intent-filter&gt;</div><div class="line">                &lt;action android:name=&quot;com.yonyou.test.aidl&quot;/&gt;</div><div class="line">            &lt;/intent-filter&gt;</div><div class="line">    &lt;/service&gt;</div></pre></td></tr></table></figure></p>
<p>  到这里,server端的代码就算完成了.下面来看client端代码.</p>
<p>  client中也有aidl文件夹,里面的内容和server端是一模一样的,只需要把server中的aidl文件夹拷过来就可以了.还有两个java对象放入和server中包名一样的目录中.</p>
<p>  最终的目录结果应该是这样的:</p>
<p><img src="/images/2017/02/android aidl目录2.png" alt="android aidl目录结构2  "></p>
<p>  最后我们在client中的MainActivity来binder server中的service.<br>  <figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</div><div class="line">  <span class="keyword">private</span> IMyAidlInterface iMyAidlInterface;</div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">      <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">      setContentView(R.layout.activity_main);</div><div class="line">      Toolbar toolbar = (Toolbar) findViewById(R.id.toolbar);</div><div class="line">      setSupportActionBar(toolbar);</div><div class="line"></div><div class="line">      FloatingActionButton fab = (FloatingActionButton) findViewById(R.id.fab);</div><div class="line">      fab.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() &#123;</div><div class="line">          <span class="meta">@Override</span></div><div class="line">          <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</div><div class="line">              Intent intent = <span class="keyword">new</span> Intent(<span class="string">"com.yonyou.test.aidl"</span>);</div><div class="line">              intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</div><div class="line">              intent.setPackage(<span class="string">"yonyou.com.testbinderipc"</span>);</div><div class="line">              bindService(intent,sc, BIND_AUTO_CREATE);</div><div class="line">          &#125;</div><div class="line">      &#125;);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">private</span> ServiceConnection sc = <span class="keyword">new</span> ServiceConnection() &#123;</div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServiceConnected</span><span class="params">(ComponentName name, IBinder service)</span> </span>&#123;</div><div class="line">          iMyAidlInterface = IMyAidlInterface.Stub.asInterface(service);</div><div class="line">          <span class="keyword">try</span> &#123;</div><div class="line">              iMyAidlInterface.addBook(<span class="keyword">new</span> Book(<span class="number">1001</span>,<span class="string">"如何阅读一本书"</span>));</div><div class="line">              List&lt;User&gt; user = iMyAidlInterface.getUser();</div><div class="line">              Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"user is "</span>+ user.get(<span class="number">0</span>).name, Toast.LENGTH_SHORT).show();</div><div class="line">          &#125; <span class="keyword">catch</span> (RemoteException e) &#123;</div><div class="line">              e.printStackTrace();</div><div class="line">          &#125;</div><div class="line">      &#125;</div><div class="line"></div><div class="line">      <span class="meta">@Override</span></div><div class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onServiceDisconnected</span><span class="params">(ComponentName name)</span> </span>&#123;</div><div class="line">          iMyAidlInterface = <span class="keyword">null</span>;</div><div class="line">      &#125;</div><div class="line">  &#125;;</div><div class="line"></div><div class="line">  <span class="meta">@Override</span></div><div class="line">  <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</div><div class="line">      <span class="keyword">super</span>.onDestroy();</div><div class="line">      unbindService(sc);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>  点击FloatingActionButton,绑定server中的service,如果toast成功,并打印出日志表明调用成功.</p>
<p>  这里有个点需要注意下,在android5.0以后如果要startService或者bindService的时候一定要明确指定对方的包名,否者会抛出异常.这里intent的包名我们就写server的包名就可以了.</p>
<p>  在onServiceConnected中我们调用了IMyAidlInterface.Stub.asInterface,这里就完成了是否是统一进程的判断,如果不同进程就返回proxy对象,如果是统一进程就直接返回stub对象.</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>  要明白的是,这里的讲的代码只是java层的binder实现,真正的binder是在底层通过c++来实现的,要明白真正的binder实现还是要去深入看源码.这里只要明白了binder的实现原理和机制就可以了.</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://weishu.me/2016/01/12/binder-index-for-newer/#comments" title="Binder学习指南" target="_blank" rel="external">Binder学习指南  </a></p>
<p><a href="http://wangkuiwu.github.io/2014/09/01/Binder-Introduce/" title="Android Binder机制(一) Binder的设计和框架" target="_blank" rel="external">Android Binder机制(一) Binder的设计和框架</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2017/02/21/2017/android binder与aidl/" data-id="cizy53xr1001m3us6y1gnv6qf" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/02/25/hello-world/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Hello World
        
      </div>
    </a>
  
  
    <a href="/2017/02/17/2017/Android LruMemoryCache源码分析/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Android LruMemoryCache源码分析</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blog/">blog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/github/">github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java-blog-github/">java blog github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java-blog-github/">java, blog, github</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/android/" style="font-size: 15px;">android</a> <a href="/tags/blog/" style="font-size: 20px;">blog</a> <a href="/tags/github/" style="font-size: 20px;">github</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/java-blog-github/" style="font-size: 10px;">java blog github</a> <a href="/tags/java-blog-github/" style="font-size: 10px;">java, blog, github</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/05/">May 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">February 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/03/06/2017/读书笔记/如何高效学习-读书笔记/">&lt;如何高效学习&gt;读书笔记</a>
          </li>
        
          <li>
            <a href="/2017/03/02/2017/读书笔记/2017-03-02-如何阅读一本书/">&lt;如何阅读一本书&gt;</a>
          </li>
        
          <li>
            <a href="/2017/02/25/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2017/02/21/2017/android binder与aidl/">android binder与AIDL</a>
          </li>
        
          <li>
            <a href="/2017/02/17/2017/Android LruMemoryCache源码分析/">Android LruMemoryCache源码分析</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>