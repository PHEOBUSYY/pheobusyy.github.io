<!DOCTYPE html><html class="has-navbar-fixed-top" lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><title></title><script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script><link rel="stylesheet" type="text/css" href="/css/bulma.css"><link rel="stylesheet" type="text/css" href="/css/justyan.css"><link rel="stylesheet" type="text/css" href="/highlight/styles/dracula.css"><link rel="icon" href="/img/favicon.png"></head><body><section class="hero is-info is-medium"><div class="hero-head"><nav class="navbar is-fixed-top is-info"><div class="container"><div class="navbar-brand"><a class="navbar-item"><img class="navbar-circle" src="https://avatars2.githubusercontent.com/u/9360264?s=50&amp;u=5e88482f7319a8ce65ed618bcede72ea97a7f5aa&amp;v=4"></a><span class="navbar-burger burger" data-target="navbarMenuHeroA"><span></span><span></span><span></span></span></div><div class="navbar-menu" id="navbarMenuHeroA"><div class="navbar-end"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/category">Categories</a><a class="navbar-item" href="/contact">Contact</a><span class="navbar-item"><a class="button is-info is-inverted" href="https://github.com/PHEOBUSYY"><span class="icon"><i class="fab fa-github"></i></span><span>Github</span></a></span></div></div></div></nav></div><div class="hero-body"><div class="has-text-centered"><h1 class="title">java design pattern - mediator pattern</h1><h2 class="subtitle">2016-06-13</h2></div></div><div class="hero-foot"></div></section><div id="content-outer"><div id="content-inner"><article id="post"><div id="toc"><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#场景"><span class="toc-number">1.</span> <span class="toc-text">场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#中介者模式"><span class="toc-number">2.</span> <span class="toc-text">中介者模式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考资料"><span class="toc-number">3.</span> <span class="toc-text">参考资料</span></a></li></ol></div></div><div class="post-text"><!-- TOC depthFrom:2 depthTo:6 withLinks:1 updateOnSave:1 orderedList:0 -->
<ul>
<li><a href="#场景">场景</a></li>
<li><a href="#中介者模式">中介者模式</a></li>
<li><a href="#参考资料">参考资料</a></li>
</ul>
<!-- /TOC -->
<h2 id="场景"><a href="#场景" class="headerlink" title="场景"></a>场景</h2><p>  在编程中经常会遇到两个或者多个复杂对象相互通讯的问题，如果对象之后互相引用的话会造成耦合严重，后续无法改动的问题<br>  这个时候可以考虑通过中介者模式来从中间完成中介的作用，来降低耦合度。</p>
<h2 id="中介者模式"><a href="#中介者模式" class="headerlink" title="中介者模式"></a>中介者模式</h2><p>  中介者模式是一种结构话模式，旨在通过一个中介者对象来完成负责对象之间的通讯。<br>  主要由4个角色组成：</p>
<ul>
<li>mediator 中介者接口，定义了通讯的行为方式</li>
<li>ConcreteMediator 具体实现中介，内部有所有负责对象的引用</li>
<li>User 抽象的复杂对象，内部引用了中介对象</li>
<li>ConcreteUser  具体复杂对象，内部的行为调用了中介对象的行为   </li>
</ul>
<p><img src="/images/2016/06/mediator_uml.gif" alt="mediator pattern"></p>
<a id="more"></a>
<p>下面是一个简单的demo实现：</p>
<pre><code class="java">public interface Mediator {
    void sendMsg(String msg, User user);
}
</code></pre>
<pre><code class="java">public class ConcreteMediator implements Mediator {
    protected ConcreteUser1 concreteUser1;
    protected ConcreteUser2 concreteUser2;

    public void setConcreteUser1(ConcreteUser1 concreteUser1) {
        this.concreteUser1 = concreteUser1;
    }

    public void setConcreteUser2(ConcreteUser2 concreteUser2) {
        this.concreteUser2 = concreteUser2;
    }

    @Override
    public void sendMsg(String msg, User user) {
        if (user == concreteUser1) {
            concreteUser1.notify(msg);
        } else {
            concreteUser2.notify(msg);
        }
    }
}
</code></pre>
<pre><code class="java">public abstract class User {
    protected Mediator mediator;

    public User(Mediator mediator) {
        this.mediator = mediator;
    }
    public abstract void sendMsg(String msg);

    public abstract void notify(String msg);
}
</code></pre>
<pre><code class="java">public class ConcreteUser1 extends User {
    public ConcreteUser1(Mediator mediator) {
        super(mediator);
    }

    @Override
    public void notify(String msg) {
        System.out.println(&quot;ConcreteUser1 said =&quot;+msg);
    }

    @Override
    public void sendMsg(String msg) {
        mediator.sendMsg(msg,this);
    }

}
</code></pre>
<pre><code class="java">public class ConcreteUser2 extends User {
    public ConcreteUser2(Mediator mediator) {
        super(mediator);
    }

    @Override
    public void sendMsg(String msg) {
        mediator.sendMsg(msg,this);
    }

    @Override
    public void notify(String msg) {
        System.out.println(&quot;ConcreteUser2 said=&quot;+msg);
    }

}
</code></pre>
<pre><code class="java">public class Test {
    public static void main(String[] args) {
        ConcreteMediator mediator = new ConcreteMediator();
        ConcreteUser1 concreteUser1 = new ConcreteUser1(mediator);
        ConcreteUser2 concreteUser2 = new ConcreteUser2(mediator);

        mediator.setConcreteUser1(concreteUser1);
        mediator.setConcreteUser2(concreteUser2);

        concreteUser1.sendMsg(&quot;Hello&quot;);
        concreteUser2.sendMsg(&quot;Hello too!&quot;);
    }
}
</code></pre>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://en.wikipedia.org/wiki/Mediator_pattern" title="Mediator pattern" target="_blank" rel="external">Mediator pattern</a></p>
</div></article><div></div></div></div><div id="bottom-outer"><div id="bottom-inner"><span>Site construction by</span><span> JustYan </span><span>using</span><a href="http://hexo.io"><span>hexo blog framework</span></a><span>.</span><br><a href="/">Home</a></div></div><script src="/js/justyan.js"></script><script src="/highlight/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></body></html>